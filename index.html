<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basquete Anota AI</title>
    <link rel="icon" type="imagem/png" href="/assets/images/ball.png" />
    <!-- Alterado para CDN do Phaser com fallback para local -->
    <script type="text/javascript">
        // Verificar se já existe uma versão do Phaser carregada
        window.Phaser = window.Phaser || null;
    </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/phaser@2.6.2/build/phaser.min.js" onerror="loadLocalPhaser()"></script>
    <script type="text/javascript">
        function loadLocalPhaser() {
            var script = document.createElement('script');
            script.src = '/js/phaser.min.js';
            document.head.appendChild(script);
        }
    </script>

    <!-- Google Adds -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2210446009817515" crossorigin="anonymous"></script>
    <!-- Google Tag Manager -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WSPVKJTS0V"></script>

    <style type="text/css">
        /* [Manter todos os estilos existentes exatamente como estão] */
    </style>
</head>
<body>

<!-- [Manter o código do Google ADS exatamente como está] -->

<script type="text/javascript">
// Funções de cookie precisam ser declaradas antes de serem usadas
const getCookie = () => {
    var scoreCookie = '0';

    if (!document.cookie.includes('BestScore')) {
        document.cookie = `BestScore=0`;
        return '0';
    }
    
    document.cookie.split(';').forEach(cookie => {
        if (cookie.includes('BestScore')) {
            scoreCookie = cookie.split('=')[1];
        }
    });
    return scoreCookie;
};

const setCookie = (newBestScore) => {
    document.cookie = `BestScore=${newBestScore}`;
};

// Inicialização das variáveis globais
var screenWidth = window.innerWidth; // Alterado de screen.width para window.innerWidth
var screenHeight = window.innerHeight;
var mobile = screenWidth <= 750;
var bestScoreCookie = getCookie();

// Resto das variáveis globais [manter como está]

// Função para garantir que o Phaser está carregado
function initGame() {
    if (typeof Phaser === 'undefined') {
        console.error('Phaser não está carregado. Tentando novamente em 1 segundo...');
        setTimeout(initGame, 1000);
        return;
    }

    if (mobile) {
        window.game = new Phaser.Game(screenWidth, screenHeight, Phaser.CANVAS, '', { 
            preload: preload, 
            create: create, 
            update: update 
        });
    } else {
        window.game = new Phaser.Game(400, 625, Phaser.CANVAS, '', { 
            preload: preload, 
            create: create, 
            update: update 
        });
    }
}

// [Manter todas as outras funções exatamente como estão: preload, create, update, etc.]

// Inicializar o jogo quando a página carregar
window.onload = function() {
    try {
        initGame();
    } catch (error) {
        console.error('Erro ao inicializar o jogo:', error);
        document.body.innerHTML = '<p style="color: white; text-align: center;">Erro ao carregar o jogo. Por favor, recarregue a página.</p>';
    }
};

</script>
<!-- [Manter o script do Cloudflare como está] -->
</body>
</html>
