<!doctype html>
<html lang="pt-BR">
<head>
  <!-- [mantenha o head como está] -->
</head>
<body>
  <script type="text/javascript">
    // [mantenha as variáveis globais como estão]

    function preload() {
      try {
        // Carregar imagens [mantenha como está]

        // Modificar o carregamento de áudio para o formato mais simples
        game.load.audio('score', 'assets/audio/score.wav');
        game.load.audio('backboard', 'assets/audio/backboard.wav');
        game.load.audio('whoosh', 'assets/audio/whoosh.wav');
        game.load.audio('fail', 'assets/audio/fail.wav');
        game.load.audio('spawn', 'assets/audio/spawn.wav');
      } catch (error) {
        console.error('Erro ao carregar assets:', error);
      }
    }

    function create() {
      try {
        // Configurar física [mantenha como está]

        // Modificar a inicialização do áudio
        game.sound.boot(); // Adicionar esta linha
        
        score_sound = game.add.audio('score', 1);
        backboard = game.add.audio('backboard', 0.5);
        whoosh = game.add.audio('whoosh', 1);
        fail = game.add.audio('fail', 0.1);
        spawn = game.add.audio('spawn', 1);

        // Habilitar áudio para dispositivos móveis
        if (mobile) {
          game.input.touch.preventDefault = false;
          game.sound.touchUnlock = function() {
            if (game.sound.usingWebAudio && game.sound.context.state === 'suspended') {
              game.input.onTap.addOnce(function() {
                game.sound.context.resume();
              });
            }
          };
          game.sound.touchUnlock();
        }

        // [resto do create como está]
      } catch (error) {
        console.error('Erro ao criar jogo:', error);
      }
    }

    function launch(xTraj) {
      if (!ball.launched) {
        ball.launched = true;
        game.physics.p2.gravity.y = 3000;
        ball.body.velocity.x = xTraj;
        ball.body.velocity.y = -1750;
        ball.body.rotateRight(xTraj / 3);
        
        // Modificar a reprodução do som
        try {
          whoosh.play();
        } catch (e) {
          console.log('Erro ao tocar som:', e);
        }
      }
    }

    function hitRim() {
      try {
        backboard.play();
      } catch (e) {
        console.log('Erro ao tocar som:', e);
      }
    }

    // [mantenha o resto das funções como estão]

    // Modificar a inicialização do jogo
    window.onload = function() {
      if (typeof Phaser === 'undefined') {
        console.error('Erro: Phaser não foi carregado!');
        document.body.innerHTML = '<p style="color: white; text-align: center;">Erro ao carregar o jogo. Por favor, recarregue a página.</p>';
        return;
      }

      screenWidth = window.innerWidth;
      var screenHeight = window.innerHeight;
      mobile = screenWidth <= 750;

      try {
        // Adicionar configurações de áudio ao criar o jogo
        game = new Phaser.Game(
          mobile ? screenWidth : 400,
          mobile ? screenHeight : 625,
          Phaser.CANVAS,
          '',
          {
            preload: preload,
            create: create,
            update: update
          },
          false, // transparente
          false, // antialias
          {
            // Configurações de áudio
            noAudio: false,
            disableWebAudio: false
          }
        );
        
        // Adicionar evento de toque para iOS
        if (mobile) {
          document.addEventListener('touchstart', function() {
            if (game.sound && game.sound.context && game.sound.context.state === 'suspended') {
              game.sound.context.resume();
            }
          });
        }
      } catch (error) {
        console.error('Erro ao inicializar o jogo:', error);
        document.body.innerHTML = '<p style="color: white; text-align: center;">Erro ao inicializar o jogo. Por favor, recarregue a página.</p>';
      }
    };
  </script>
</body>
</html>
